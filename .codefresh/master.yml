version: '1.0'
steps:
  test:
    image: golang:1.14
    working_directory: /go/src/github.com/chartmuseum
    commands:
      - export TEST_STORAGE_OPENSTACK_CONTAINER=gotestcontainer
      - export ST_AUTH=http://swift_aio:8080/auth/v1.0
      - export ST_USER=test:tester
      - export ST_KEY=testing
      - ln -s /codefresh/volume/${{CF_REPO_NAME}} storage && cd storage
      - make ci-setup testcloud
    services:
      composition:
        swift_aio:
          image: bouncestorage/swift-aio
          ports:
            - 8080